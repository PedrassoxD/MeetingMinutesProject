<div class="container">
    <button class="btn boton my-2 my-sm-0" (click)="submittedTrue()"><i class="fas fa-plus"></i> Crear Temas</button>
    <br>
    <br>
    <div *ngIf="submitted">
        <form [formGroup]="nuevoTemaform" (ngSubmit)="crearTema(nuevoTemaform)" method="POST">
            <div class="form-group">
                <label for="titulo">Titulo</label>
                <input type="text" class="form-control col-sm-5" formControlName="titulo" id="titulo" placeholder="Titulo...">
            </div>
            <div class="form-group">
                <label for="etiqueta">Etiqueta</label>
                <select class="form-control col-sm-5" id="etiqueta" formControlName="etiqueta">
                    <option value="ACTUAL">Actual</option>
                    <option value="RECURRENTE">Recurrente</option>
                </select>
            </div>
            <button [disabled]="!nuevoTemaform.valid" type="submit" class="btn btn-success">Añadir</button>
            <button type="submit" class="btn btn-light" (click)="submitted = false">Cancelar</button>
        </form>
    </div>
    <div *ngIf="existeTema">
        <div class="row">
            <div class="col-2">
                <h3>Temas</h3>
            </div>
            <div class="col">
                <div id="accordion">
                    <h5 class="mb-0">
                        <button class="btn btn-danger btn-sm" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                          <a>Mostrar información de temas. <i class="fas fa-angle-down"></i></a>
                        </button>
                    </h5>
                </div>
            </div>
        </div>
        <br>
        <div *ngFor="let tem of temas">
            <div class="card">
                <div class="card-body">
                    <div class="row">
                        <div class="col-sm-11">
                            <h4 class="card-title">{{tem.titulo}} <span>*{{tem.etiqueta}}*</span></h4>
                        </div>
                        <div class="col">
                            <div class="dropdown">
                                <button type="button" class="boton2 dropdown-toggle" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i class="fas fa-ellipsis-v"></i></button>
                                <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                                    <a class="dropdown-item" (click)="verModal(tem.codTema, infoModal)">Añadir información</a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div *ngIf="tem.info !== null">
                        <div id="collapseOne" class="collapse" aria-labelledby="headingOne" data-parent="#accordion">
                            <p>{{tem.info}}</p>
                        </div>
                    </div>
                </div>
            </div>
            <br>
        </div>
    </div>
</div>

<ng-template #infoModal>
    <div class="modal-header">
        <h4 class="modal-title">Información para el tema</h4>
    </div>
    <div class="modal-body">
        <form [formGroup]="infoForm" (ngSubmit)="modificarTema(infoForm)">
            <div class="form-group">
                <label for="info">Información</label>
                <textarea id="info" name="info" class="form-control" formControlName="info" placeholder="Escriba la información del tema..."></textarea>
                <div class="alert alert-danger" *ngIf="(info.touched) && (info.invalid)" style="margin-top: 5px;">
                    <span *ngIf="info.errors.required">La clave es un campo requerido</span>
                    <span *ngIf="info.errors.maxlength">
                    Longitud máxima de carácteres: {{info.errors.maxlength.requiredLength}}
                    </span>
                </div>
            </div>
            <div class="modal-footer">
                <button [disabled]="!infoForm.valid" type="submit" class="btn btn-success">Añadir</button>
                <button type="button" class="btn btn-light" (click)="cerrarModal(infoModal)">Cerrar</button>
            </div>
        </form>
    </div>
</ng-template>